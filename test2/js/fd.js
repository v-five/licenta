/* generated Wed May 30 08:17:05 EDT 2012 */

R9.extend("airportPicker",{hasAirports:function(){return !!jq("#airportListContainer input[name=customairport]").size()},select:function(f){var e=document.customair,d=[],c=4;jq(e).find("input[type='checkbox']").each(function(g){if(jq(this).prop("checked")){d.push(jq(this).val())}});if(d.length==0){alert("Please select at least one airport.");return}if(d.length>c){alert("You only may choose a maximum of 4 airports.");return}var b=d.join(", "),a=jq("#sbhint").val();if(a){jq("#cacode").val(a)}f({id:b.length>3?"C-"+jq("#cacode").val()+"-"+jq("#radius").val():b,name:b});jq(this.selector).r9dialog("destroy").remove()},selector:"#customAirportDlg",setMap:function(a){jq("#customAirportsMapDiv").css("background-image","url("+a+")")},show:function(b){var a=this;var c={startcode:typeof b.code==="function"?b.code():b.code,startlocation:typeof b.location==="function"?b.location():b.location};if(b.hint){c.sbhint=b.hint}jq("#customAirportDlg").remove();jq.ajax({type:"GET",url:this.url,data:c,dataType:"html",success:function(e){var d=jq(e);d.find("#customAirportSearchBtn").button().click(function(){R9.airportPicker.select(b.callback);return false});d.find("#customAirportRefreshBtn").click(function(){R9.airportPicker.update();return false});d.find("#calocation").smartbox({callback:function(f){jq("#cacode").val(f.id);if(f.type=="ap"||f.type=="city"){var g=f.id.split("/");if(g.length>1){document.getElementById("cacode").value=f.id=g[1]}jq("#sbhint").val("");jq("#radiusTD").css("visibility","visible")}else{if(f.type){jq("#cacode").val("");jq("#sbhint").val(f.id);jq("#radiusTD").css("visibility","hidden")}}R9.airportPicker.update()},minWidth:175,smartUrl:"/f/smarty.php"});d.find("input.defaultCheckbox").checkbox();d.find("select.defaultSelect").selectmenu();d.r9dialog({position:["center",40],title:b.title,width:920});a.bindMapPinHover();a.bindCheckboxesToButton()},error:function(e,f,d){alert(f)},cache:false})},bindCheckboxesToButton:function(){jq("#customAirportDlg").find("input.defaultCheckbox").click(function(){var a=0;jq(document.customair).find("input[type='checkbox']").each(function(c){if(jq(this).prop("checked")){a++}});var b=jq("#customAirportSearchBtn");(a==0)?b.addClass("ui-button-gray"):b.removeClass("ui-button-gray")})},update:function(){var a=this;jq.ajax({type:"GET",url:this.url,data:{dataonly:"true",cacode:document.getElementById("cacode").value,calocation:document.getElementById("calocation").value,radius:jq("#radius").val(),sbhint:document.getElementById("sbhint").value},dataType:"html",success:function(b){jq("#customAirportsActionButtons").show();jq("#airportListContainer").html(b);jq("#airportListContainer input.defaultCheckbox").checkbox();jq("#customAirportsActionButtons")[R9.airportPicker.hasAirports()?"show":"hide"]();a.bindCheckboxesToButton()},error:function(c,d,b){alert(d)},cache:false})},clearPins:function(b,a,c){jq("#customAirportsMapDiv").find(".airportPin, .emptyMapText").remove()},bindMapPinHover:function(){jq("tr.airportItem td").hover(function(){var a=jq(this).parent().attr("id").slice(2);jq(this).parent().toggleClass("hover");jq("#customPin"+a).toggleClass("active")})},addPins:function(b){var a=this;jq.each(b,function(c,e){var g=e.xCoord+a.markerOffset[0];var d=e.yCoord+a.markerOffset[1];var f=replaceArgs("<div id='customPin{4}' class='airportPin' style='left: {0}px; top: {1}px;' title='{3}'>{2}</div>",g,d,e.pinLabel,e.hoverText,e.itemID);jq("#customAirportsMapDiv").append(f)});a.bindMapPinHover()},markerOffset:[-14,-31],url:"/s/run/toolbox/customairports"});R9.extend("fd.flights",{AbstractForm:function(a){R9.fd.ODForm.call(this,a)}});R9.fd.flights.AbstractForm.prototype=R9.fd.ODForm.prototype.beget();R9.extend("fd.flights.AbstractForm.prototype",{bindEvents:function(){R9.fd.ODForm.prototype.bindEvents.call(this)},loadHistory:function(d,b,e){R9.fd.ODForm.prototype.loadHistory.call(this);var a=this;a.setSourceForHistory(e);a.isSubmitted=false;a.suppressBuzzCal=e;if(b>=0){if(e){skipCompare=true}var c=a.history[b];if(c){a.loadHistoryItem(c,e)}if(e){skipCompare=false}}a.e.personality.value="";a.hasAutoloadedHistoryAlready=true;return false},submitRecentFlight:function(){var a=this.e;setTimeout(function(){jq(a).submit()},500)}});R9.extend("fd.flights",{MultiCityForm:function(a){R9.fd.flights.AbstractForm.call(this,a)}});R9.fd.flights.MultiCityForm.prototype=R9.fd.flights.AbstractForm.prototype.beget();R9.extend("fd.flights.MultiCityForm.prototype",{bindDatepicker:function(){var a=this;jq.each(a.departDate,function(b,c){jq("#depart_date"+b).datepicker({altField:"#depart_date_dom"+b+"label",beforeShow:a.resetMinDate,defaultDate:c||null});if(jq("html").hasClass("touch")){jq("#depart_date"+b).attr("readonly",true)}})},bindEvents:function(){R9.fd.flights.AbstractForm.prototype.bindEvents.call(this);this.bindDatepicker();this.bindOneWay();this.bindSmartbox();this.bindMoreLegsButton();this.bindClearLegsButton()},bindOneWay:function(){jq(this.e).find("input[name=oneway]").click(jq.proxy(this.toggleOneWay,this))},bindMoreLegsButton:function(){var a=this;jq("#addMoreLegs").click(function(){a.exposeLegs(-1)})},bindClearLegsButton:function(){var a=this;jq("#clearLegs").click(function(){a.clearAllLegs()})},bindSmartbox:function(){var b=this.e;var a=this;jq("input.autocomplete[id^=destination]").each(function(){var c=this.id.substring(11),d=jq("#destcode"+c);jq(this).smartbox({callback:function(e){d.val(e?e.id:"")},callbackWithNull:true,minWidth:180,recentList:a.smartboxHistory})});jq("input.autocomplete[id^=origin]").each(function(){var c=this.id.substring(6),d=jq("#origincode"+c);jq(this).smartbox({callback:function(e){d.val(e?e.id:"")},callbackWithNull:true,minWidth:180,recentList:a.smartboxHistory}).focus(function(){if(!this.value&&!jq(this).data("prefill")){jq(this).data("prefill",true);try{if(c-0>0){var g=(c-0-1),f=b["destination"+g],e=b["destcode"+g];this.value=f.value;d.val(e.value);this.focus();setTimeout(function(){jq("#"+this.id).select()},50)}}catch(h){}}})})},loadHistoryItem:function(c,g){var b=this,h=b.e,a=b.getTodayDate();var i=(window.location.search.indexOf("travelers=")!=-1);if(!i){jq(h.travelers).val(c.travelers);if(h.adults){jq(h.adults).val(c.adults||"0")}jq(h.seniors).val(c.seniors||"0");jq("#ptcChildren").val(c.children||"0");if(c.childAges){jq.each(c.childAges,function(e,k){var j=e+1;jq("#childAge"+j).val(k)})}b.adjustChildPTCAges();if(c.adults>0){b.displayFullPTC()}}jq(h.cabin).val(c.cabin);h.prefer_nonstop.checked=c.snonstop;h.fid.value=c.fid;for(var f=0;f<b.maxLegs;f++){if(f<c.leg.length){h["origin"+f].value=c.leg[f].origin;h["destination"+f].value=c.leg[f].destination;h["destcode"+f].value="";h["origincode"+f].value="";h["nearbyO"+f].checked=c.leg[f].nearbyO;h["nearbyD"+f].checked=c.leg[f].nearbyD;var d=new Date(Date.parse(c.leg[f].leave));if(d!=null&&d.getTime()>=a.getTime()){jq("#depart_date"+f).datepicker("setDate",d);jq("#depart_date_dom"+f+"label").text(jq.datepicker.formatDate("D, d M yy",d))}else{if(g){alert("The dates for this flight search have expired, please enter new dates.")}h["depart_date"+f].value="";g=false}jq(h["depart_time"+f]).val(c.leg[f].timechoice)}else{b.clearLegInputs(f)}}b.exposeLegs(c.leg.length);h.recent.value="Y";if(g){uncheckcomparetos(h);b.submitRecentFlight()}},loadSettings:function(a){R9.fd.flights.AbstractForm.prototype.loadSettings.call(this,a);this.cabin=a.cabin;this.departDate=a.departDate;this.maxLegs=a.maxLegs;this.travelers=a.travelers;this.useLast=!!a.useLast;this.defaultLegsToShow=a.defaultLegsToShow||2},onLoad:function(){R9.fd.flights.AbstractForm.prototype.onLoad.call(this);var a=this,c=a.e;if(c.Search){c.Search.disabled=false}if(a.useLast){a.loadHistory(null,0,false)}a.setDefaultVals();jq("span.buttonSet").buttonset();a.exposeLegs(this.defaultLegsToShow);setCmp2Count();R9LoadFinished=new Date();var b=R9LoadFinished.getTime()-R9StartPage.getTime();recordEvent("client page load","front door","flights","ms",b);if(a.submitOnPost){setTimeout(function(){jq(c).submit()},250)}},onSubmit:function(){R9.fd.flights.AbstractForm.prototype.onSubmit.call(this);if(!this.isSubmitted){if(this.isValid()){this.disableSearchButton();document.lasttab.havesearched.value="true";this.swapButtons();this.isSubmitted=true;Profiler.markSearchStart();var a=this.generateSearchUrl();if(a!=null){document.location.href=a;return false}return true}else{jq('<div class="fdSearchError"><div class="liner">'+this.error.replace(/\n/g,"<br />")+"</div></div>").r9dialog({hideTitle:true,width:525})}}return false},isValid:function(){var f=R9.utils.formToObject(this.e);error=null;for(var e=0;e<this.maxLegs;e++){var b=f["origin"+e];var a=f["destination"+e];var d=f["depart_date"+e];var c=null;if(!b.trim()&&a.trim()){c="Please enter a valid 'From' airport for flight LEGNUM.".replace("LEGNUM",e)}else{if(!a.trim()&&b.trim()){c="Please enter a valid 'To' airport for flight LEGNUM.".replace("LEGNUM",e)}else{if(b.trim()&&a.trim()&&!d.trim()){c="Please enter a valid date for flight LEGNUM.".replace("LEGNUM",e)}else{if(!b.trim()&&!a.trim()&&d.trim()){c="Please enter valid airports for flight LEGNUM.".replace("LEGNUM",e)}}}}if(error===null){error=c}else{if(c!==null){error+="</br>";error+=c}}if(error==null&&jq("#travelerSelectionFull").hasClass("open")){error=this.checkForPTCErrors(f)}}return(this.error=error)===null},setDefaultVals:function(){var a=this,b=a.e;if(a.cabin){b.cabin.value=a.cabin}if(a.travelers){b.travelers.value=a.travelers}},clearLegInputs:function(b){var a=this,c=a.e;c["origin"+b].value="";c["destination"+b].value="";c["destcode"+b].value="";c["origincode"+b].value="";c["nearbyO"+b].checked=false;c["nearbyD"+b].checked=false;c["depart_date"+b].value="";jq(c["depart_time"+b]).val("a")},toggleOneWay:function(){if(!this.e.oneway[2].checked){if(this.e.oneway.length>3&&this.e.oneway[3].checked){location.href="/flights?mc=w"}else{location.href="/flights"+(this.e.oneway[1].checked?"?oneway=y":"")}}},toggleFlexCategory:function(){},resetMinDate:function(a,b){var d=parseInt(b.id.slice(b.id.length-1),10);if(d>0){var e=null,c=d-1;while(e==null&&c>=0){e=jq("#depart_date"+c).datepicker("getDate");c--}if(e){jq("#depart_date"+d).datepicker("option","minDate",e)}}},clearAllLegs:function(){var a=this;for(var b=0;b<this.maxLegs;b++){a.clearLegInputs(b)}},exposeLegs:function(a){var b=this;if(a>0&&a<=this.maxLegs){for(var d=0;d<this.maxLegs;d++){var e=jq("#multiCityLeg"+d);var c=jq("#origin"+d).val();if(d<a||c.length>0){e.show()}else{b.clearLegInputs(d);e.hide()}}(a==this.maxLegs)?jq("#addMoreLegs").hide():jq("#addMoreLegs").show()}else{if(a==-1){for(var d=0;d<this.maxLegs;d++){var e=jq("#multiCityLeg"+d);if(!e.is(":visible")){e.slideDown();(d==this.maxLegs-1)?jq("#addMoreLegs").hide():jq("#addMoreLegs").show();break}}}}}});R9.extend("fd.flights",{Form:function(a){R9.fd.ODForm.call(this,a)}});R9.fd.flights.Form.prototype=R9.fd.flights.AbstractForm.prototype.beget();R9.extend("fd.flights.Form.prototype",{bindEvents:function(){R9.fd.flights.AbstractForm.prototype.bindEvents.call(this);this.bindBuzzCalendar();this.bindOneWay();this.bindSmartbox();this.bindAirportPicker();this.bindDoublePicker();this.bindFlexDates();this.bindXSell()},bindBuzzCalendar:function(){jq(this.e).bind("checkBuzzCalendar",jq.proxy(this.checkBuzzCalendar,this));jq(".fdMainRight").delegate("#buzzcalendarcloselink","click",function(){jq(".fdRailSection").show();jq("#fdCalContainer").remove()})},bindOneWay:function(){jq(this.e).find("input[name=oneway]").click(jq.proxy(this.toggleOneWay,this))},bindXSell:function(){jq(".newWindowIcon").tipTip({delay:100,edgeOffset:3,maxWidth:"300px"})},bindSmartbox:function(){var a=this;jq("#destination,#origin").focus(function(){a.clearHelpText(this)}).smartbox({callback:function(d){var b=this.name=="origin",c=jq(b?"#origincode":"#destcode").val(d?d.id:"");if(d){if(d.type=="ap"){compare2chk();a.checkBuzzCalendar()}else{if(d.type==="isl"){this.value=d.str;c.val("")}else{this.value="";c.val("");if(d.type){R9.airportPicker.show(jq.extend({hint:d.id},b?R9.fd.flights.airportPickerSettings.from:R9.fd.flights.airportPickerSettings.to))}}}}},callbackWithNull:true,minWidth:a.smartboxMinWidth,smartUrl:a.smartUrl,recentList:a.smartboxHistory}).blur(function(){var b=jq(this.name=="origin"?"#origincode":"#destcode");if(b.val().length){return}a.callbackRefreshCmp2(b)})},checkBuzzCalendar:function(a,g){var j=this,h=j.e;if(j.hasAutoloadedHistoryAlready&&j.isBuzzCalendarEnabled&&!j.flyNow&&!j.suppressBuzzCal){if(jq(h.oneway[0]).prop("checked")){var b=h.origincode.value,c=h.destcode.value,i=h.depart_date.value;b=!b?h.origin.value:b.substr(0,3);c=!c?h.destination.value:c.substr(0,3);if(b.length==3&&c.length==3&&b.indexOf("C-")!=0&&c.indexOf("C-")!=0){var f;if(g&&g.length==6){f=new Date(parseInt(g.substr(0,4),10),parseInt(g.substr(4,2),10)-1,15);i=buzzCalDateFormat(parseInt(g.substr(4,2),10),15,parseInt(g.substr(0,4),10))}else{f=jq("#depart_date").datepicker("getDate")||new Date()}if(f){var d=b+c+f.getMonth()+"|"+f.getFullYear();if(j.lastBuzzCalDate===null||d!=j.lastBuzzCalDate){j.fetchBuzzCalendar(b.toUpperCase(),c.toUpperCase(),i);j.lastBuzzCalDate=d}}}}else{jq("#fdCalContainer").hide()}}},getSharedParams:function(){var a=this.e;setupSearchParams(["origin=",a.origin.value,"&origincode=",a.origincode.value,"&destination=",a.destination.value,"&destinationcode=",a.destcode.value,"&nearbyO=",((jq(a.nearbyO).prop("checked"))?"y":"n"),"&nearbyD="+((jq(a.nearbyD).prop("checked"))?"y":"n")].join(""))},isOneWaySelected:function(a){return(this.flyNow||(a||jq(this.e.oneway).filter(":checked").val())==="y")},isValid:function(){var d=this.getData(),f=this.isOneWaySelected(d.oneway),c=(d.dtFlexCat=="weekend"),e=(d.dtFlexCat=="openflex"),b=null;var a=/^[0-9]/;if(!d.origin){b="Please enter a 'from' airport."}else{if(!d.destination){b="Please enter a 'to' airport."}else{if(!d.depart_date&&!c){b="Please enter a 'Depart' date."}else{if(!f&&!c&&!e&&!d.return_date){b="Please enter a 'Return' date.  If you wish to do a one-way flight, please click the 'One-way' radio button above."}else{if(d.origin===d.destination){b="Please enter unique 'from' and 'to' airports."}else{if(!f&&!c&&e&&(!d.lengthofstay||d.lengthofstay.match(a)==null)){b="Please enter a valid number of nights at the destination (max. range is 7 nights e.g. 14-21)."}}}}}}if(b==null&&jq("#travelerSelectionFull").hasClass("open")){b=this.checkForPTCErrors(d)}return(this.error=b)===null},loadSettings:function(b){var a=this;R9.fd.flights.AbstractForm.prototype.loadSettings.call(a,b);a.cabin=b.cabin;a.flyNow=!!b.flyNow;a.departTime=b.departTime;a.isBuzzCalendarEnabled=!!b.isBuzzCalendarEnabled;a.lastAirport=b.lastAirport;a.lastBuzzCalDate=null;a.returnTime=b.returnTime;a.smartUrl=b.smartUrl;a.suppressBuzzCal=!!b.suppressBuzzCal;a.travelers=b.travelers;a.defaultFlexVal=b.defaultFlexVal||"";a.departDate=b.departDate;a.isOpenFlexEnabled=!!b.isOpenFlexEnabled;a.returnDate=b.returnDate;a.smartboxHistory=b.smartboxHistory;a.smartboxMinWidth=b.smartboxMinWidth||287;a.flexDateCategory=b.flexDateCategory;a.useLast=!!b.useLast},onLoad:function(){R9.fd.flights.AbstractForm.prototype.onLoad.call(this);this._extendSelectMenuFeatures();var a=this,c=a.e;if(c.Search){c.Search.disabled=false}a.setDefaultVals();if(a.useLast){a.loadHistory(null,0,false)}jq("span.buttonSet").buttonset();setCmp2Count();R9LoadFinished=new Date();var b=R9LoadFinished.getTime()-R9StartPage.getTime();recordEvent("client page load","front door","flights","ms",b);if(this.flexDateCategory!=null&&this.flexDateCategory.length>0){jq(":radio[value="+this.flexDateCategory+"]").prop("checked",true)}if(jq("#lengthofstay").val().length==0){jq("#lengthofstay").val("6-8")}if(this.submitOnPost){setTimeout(function(){jq(c).submit()},250)}},onSubmit:function(){R9.fd.flights.AbstractForm.prototype.onSubmit.call(this);Profiler.markSearchStart();if(!this.isSubmitted){if(this.isValid()){if(comparewindows(this.e)){this.disableSearchButton();document.lasttab.havesearched.value="true";this.swapButtons();this.isSubmitted=true;var a=generateSearchUrl(this.e);if(a!=null){loadResults(a);return false}return true}else{popupBlockerMsg(this.e)}}else{jq('<div class="fdSearchError"><div class="liner">'+this.error.replace(/\n/g,"<br />")+"</div></div>").r9dialog({hideTitle:true,width:525})}}return false},setDefaultVals:function(){var a=this,b=a.e;if(a.cabin){b.cabin.value=a.cabin}if(a.departTime){b.depart_time.value=a.departTime}if(a.returnTime){b.return_time.value=a.returnTime}if(a.travelers){b.travelers.value=a.travelers}},toggleOneWay:function(){if(!jq(this.e.oneway[3]).prop("checked")){if(jq(this.e.oneway[2]).prop("checked")){location.href="/flights?mc=y"}else{this.getSharedParams();location.href="/flights"+((jq(this.e.oneway[1]).prop("checked"))?"?oneway=y":"")}}},bindAirportPicker:function(){jq("#customFrom a").click(function(){R9.airportPicker.show(R9.fd.flights.airportPickerSettings.from);return false});jq("#customTo a").click(function(){R9.airportPicker.show(R9.fd.flights.airportPickerSettings.to);return false})},bindDoublePicker:function(){var a=this;R9.dp.doublePicker({altField:"#depart_date_domlabel",defaultDate:jq.r9datepicker.parseDate(this.departDate),onSelect:function(){a.checkBuzzCalendar();a.calcNewReturnDateForOpenFlex()},selector:"#depart_date"},{altField:"#return_date_domlabel",defaultDate:jq.r9datepicker.parseDate(this.returnDate),onSelect:function(){a.checkWeekendDates()},selector:"#return_date"});if(jq("html").hasClass("touch")){jq("#depart_date").attr("readonly",true);jq("#return_date").attr("readonly",true)}},bindFlexDates:function(){var a=this;jq("#myDatesFlexible").click(function(){if(!jq("#myDatesFlexible").hasClass("open")){jq("#myDatesFlexible").addClass("open");jq("#datesPlusMinusThree").prop("checked",true);jq("#flexDateOptions").animate({width:"toggle",opacity:"toggle"},350)}else{jq("#datesExact").prop("checked",true);jq("#flexDateOptions").animate({width:"toggle",opacity:"toggle"},350,function(){jq("#myDatesFlexible").removeClass("open")})}a.toggleFlexCategory();return false});jq("input[name=dtFlexCat]").change(function(){a.toggleFlexCategory()})},calcNewReturnDateForOpenFlex:function(){var c=jq("#depart_date").datepicker("getDate");if(c!=null){c.setDate(c.getDate()+34);jq("#calc_return_date_domlabel").text(jq.datepicker.formatDate("D, d M yy",c));var b=jq.datepicker.formatDate("dd/mm/yy",c);var a="to "+b+" ";jq("#calc_numerical_return_date").text(a,c)}else{jq("#calc_return_date_domlabel").text("");jq("#calc_numerical_return_date").text("")}},loadHistoryItem:function(j,c){var k=this,h=k.e,f=k.getTodayDate();if(k.hasAutoloadedHistoryAlready){h.origin.value=j.leg[0].origin;k.clearHelpText(h.destination);h.destination.value=j.leg[0].destination;h.destcode.value="";h.origincode.value="";h.fid.value=j.fid;var l=new Date(Date.parse(j.leg[0].leave)),d=new Date(Date.parse(j.leg[j.leg.length-1].leave));if(l!=null&&l.getTime()>=f.getTime()){jq("#depart_date").datepicker("setDate",l);jq("#depart_date_domlabel").text(jq.datepicker.formatDate("D, d M yy",l));if(j.leg.length==2){var i=new Date(Date.parse(j.leg[1].leave));jq("#return_date").datepicker("setDate",i);jq("#return_date_domlabel").text(jq.datepicker.formatDate("D, d M yy",i))}}else{if(!j.weekend){if(c){alert("The dates for this flight search have expired, please enter new dates.")}jq("#depart_date,#return_date").datepicker("setDate",null);jq("#depart_date_domlabel,#return_date_domlabel").text("dd/mm/yy");c=false}}}jq(h.nearbyO).prop("checked",j.leg[0].nearbyO);jq(h.nearbyD).prop("checked",j.leg[0].nearbyD);jq(h.prefer_nonstop).prop("checked",j.snonstop);var b=(window.location.search.indexOf("travelers=")!=-1);if(k.hasAutoloadedHistoryAlready||!b){jq(h.travelers).val(j.travelers);if(h.adults){jq(h.adults).val(j.adults||"0")}jq(h.seniors).val(j.seniors||"0");jq("#ptcChildren").val(j.children||"0");if(j.childAges){jq.each(j.childAges,function(e,n){var m=e+1;jq("#childAge"+m).val(n)})}k.adjustChildPTCAges();if(j.adults>0){k.displayFullPTC()}}jq(h.cabin).val(j.cabin);jq(h.depart_time).val(j.leg[0].timechoice);jq(h.depart_date_flex).val(j.leg[0].flexdate);if(j.leg.length==2){jq(h.return_time).val(j.leg[1].timechoice);jq(h.return_date_flex).val(j.leg[1].flexdate)}var g=(window.location.search.indexOf("return_date=")!=-1);var a=(window.location.search.indexOf("oneway=y")!=-1);if((j.leg.length==1||a)&&(k.hasAutoloadedHistoryAlready||!g)){if(!k.flyNow){jq(h.oneway[1]).prop("checked",true);if(j.leg[0].flexdate==""||j.leg[0].flexdate=="exact"){jq("#datesExact").prop("checked",true)}else{jq("#datesPlusMinusThree").prop("checked",true)}}}else{jq(h.oneway[0]).prop("checked",true);try{if((j.leg[0].flexdate==""||j.leg[0].flexdate=="exact")&&(j.leg[1].flexdate==""||j.leg[1].flexdate=="exact")){jq("#datesExact").prop("checked",true)}else{jq("#datesPlusMinusThree").prop("checked",true)}}catch(h){jq("#datesExact").prop("checked",true)}}if(j.weekend){jq("#datesWeekend").prop("checked",true);jq(h.weekend_depart_date).val(j.leg[0].leave);jq(h.weekend_depart).val(j.leg[0].day1);jq(h.weekend_return).val(j.leg[0].day2)}else{if(j.leg.length==2&&j.leg[1].flexdate=="open"){jq("#datesOpenFlex").prop("checked",true);jq(h.lengthofstay).val(j.openflexrange)}}k.toggleFlexCategory();k.toggleOneWay();h.recent.value="Y";if(c){uncheckcomparetos(h);k.submitRecentFlight()}},toggleFlexCategory:function(){var a=this,b="exact";var d=jq("input[name=dtFlexCat]:checked").val();var c=d.substring(0,1).toUpperCase()+d.slice(1);if(d=="exact"){jq("#leaveDateFlex,#returnDateFlex").val("exact")}else{if(d=="plusminusthree"){if(jq("#leaveDateFlex").val()===b&&jq("#returnDateFlex").val()===b){jq("#leaveDateFlex,#returnDateFlex").val(a.defaultFlexVal)}}else{if(d=="weekend"){jq("#leaveDateFlex,#returnDateFlex").val("exact")}else{if(d=="openflex"){jq("#leaveDateFlex,#returnDateFlex").val("exact");a.calcNewReturnDateForOpenFlex()}}}}jq(".flexAware").hide();jq(".flexAware"+c).show();if(d!="exact"){jq("#flexDateOptions").show()}else{jq("#flexDateOptions").hide()}jq("span.buttonSetFlexDates").buttonset("refresh")},toggleOneWay:function(b){if(this.flyNow){jq(".roundtriponly, #compareToRow, .flexdate, .daterow, .recentarea").hide()}else{if(this.e.oneway.length>2&&jq(this.e.oneway[2]).prop("checked")){location.href="/flights?mc=y"}else{jq("#returnDateTD, #return_flex_td, .roundtriponly").css("visibility",this.e.oneway[1].checked?"hidden":"");if(!b){compare2chk();this.checkBuzzCalendar()}var a=jq(this.e.oneway[1]).prop("checked");if(a){var c=jq("input[name=dtFlexCat]:checked").val();if(c=="weekend"||c=="openflex"){jq("#datesPlusMinusThree").prop("checked",true)}}jq("#datesWeekend").prop("disabled",a);jq("#datesOpenFlex").prop("disabled",a)}}jq("span.buttonSetFlightSearchTypes").buttonset("refresh");this.toggleFlexCategory()},checkWeekendDates:function(){compare2chk()},buzzCalMonthChange:function(a){alert("cal cahnge "+jq(this).val())},fetchBuzzCalendar:function(a,d,c){var b=this;jq.ajax({type:"GET",url:"/h/farealert",data:{forcedisplay:true,nolink:"Y",calendar:true,o:a,d:d,depart_date:c},dataType:"html",success:function(e){if(e.length<=100){jq("#fdCalContainer").hide();return}if(jq("#fdCalContainer").size()==0){jq('<div id="fdCalContainer" class="fdRailSection fdRailSectionTop"></div>').prependTo(".fdMainRight")}jq(".fdRailSection:not(.ignoreBuzzClobber)").hide();jq("#fdCalContainer").html(e).show().find("select.defaultSelect").selectmenu();jq("#buzzcaltm").change(function(){b.checkBuzzCalendar(null,jq("#buzzcaltm").val())})},cache:true})}});R9.extend("fd.flights.airportPickerSettings",{from:{callback:function(b){var a=document.flights;a.origincode.value=b.id;a.origin.value=b.name;a.nearbyO.checked=false;compare2chk();jq(a).trigger("checkBuzzCalendar")},code:function(){return document.flights.origincode.value},location:function(){return document.flights.origin.value},title:"Choose up to 4 origin airports"},to:{callback:function(b){var a=document.flights;a.destcode.value=b.id;a.destination.value=b.name;a.nearbyD.checked=false;compare2chk();jq(a).trigger("checkBuzzCalendar")},code:function(){return document.flights.destcode.value},location:function(){return document.flights.destination.value},title:"Choose destination airports"}});

;var jsck_fd="v459";
/* et=1, mt=9, c=p4, i=sparkle006, v=R122, cc=4, r=none */
